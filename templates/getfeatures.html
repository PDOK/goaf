<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>BGT</title>
    <link rel="stylesheet" href="https://unpkg.com/purecss@1.0.1/build/pure-min.css"
          integrity="sha384-oAOxQR6DkCoMliIh8yFnu25d7Eq/PHS21PClpwjOTeU2jRSq11vu66rf90/cZr47" crossorigin="anonymous">
    <!--[if lte IE 8]>
    <link rel="stylesheet" href="https://unpkg.com/purecss@1.0.1/build/grids-responsive-old-ie-min.css">
    <![endif]-->
    <!--[if gt IE 8]><!-->
    <link rel="stylesheet" href="https://unpkg.com/purecss@1.0.1/build/grids-responsive-min.css">
    <!--<![endif]-->

    <style>
        html {
            box-sizing: border-box;
            overflow: -moz-scrollbars-vertical;
            overflow-y: scroll;
        }

        *,
        *:before,
        *:after {
            box-sizing: inherit;
        }

        body {
            margin: 20px;
            background: #fafafa;
        }
    </style>

    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.5.1/dist/leaflet.css"
    integrity="sha512-xwE/Az9zrjBIphAcBb3F6JVqxf46+CDLwfLMHloNu6KEQCAWi6HcDUbeOfBIptF7tcCzusKFjFw2yuvEpDL9wQ=="
    crossorigin=""/>
    <script src="https://unpkg.com/leaflet@1.5.1/dist/leaflet.js"
    integrity="sha512-GffPMF3RvMeYyc1LWMHtK8EbPv0iNZ8/oTtHPx9/cc2ILxQ+u905qIwdpULaqDkyBKgOaB57QTMg7ztg8Jm2Og=="
    crossorigin=""></script>
    <script src="https://unpkg.com/proj4@2.5.0/dist/proj4-src.js"></script>
    <script src="https://unpkg.com/proj4leaflet@1.0.1"></script>
    <style>
        .map {
            height: 400px;
            width: 100%;
        }
        .leaflet-container {
            background-color:white;
        }
    </style>

</head>
<body>

<h2>Feature Collection</h2>

<h3>Returned # {{.NumberReturned}}</h3>

<h3>Links</h3>
<table class="pure-table pure-table-bordered">
    <thead>
    <tr>
        <th>Title</th>
        <th>Content-Type</th>
        <th>Relation-Type</th>
        <th>Href</th>
    </tr>
    </thead>

    <tbody>
    {{range  $i, $link := .Links}}
        <tr {{if isOdd $i}}class="pure-table-odd" {{end}}>
            <td>{{$link.Title}}</td>
            <td>{{$link.Type}}</td>
            <td>{{$link.Rel}}</td>
            <td><a href="{{$link.Href}}"> {{$link.Href}} </a></td>
        </tr>
    {{end}}
    </tbody>
</table>

<h3>Map</h3>
<div id="map" class="map"></div>
<script type="text/javascript">
    
    var RD = new L.Proj.CRS(
        'EPSG:28992',
        '+proj=sterea +lat_0=52.15616055555555 +lon_0=5.38763888888889 +k=0.9999079 +x_0=155000 +y_0=463000 +ellps=bessel +units=m +towgs84=565.2369,50.0087,465.658,-0.406857330322398,0.350732676542563,-1.8703473836068,4.0812 +no_defs', {
        origin: [-285401.92, 22598.08],
        resolutions: [3440.640, 1720.320, 860.160, 430.080, 215.040, 107.520, 53.760, 26.880, 13.440, 6.720, 3.360, 1.680, 0.840, 0.420, 0.210, 0.105],
        bounds: L.bounds([-285401.92, 22598.08], [595401.920, 903401.920])
    });

    brtLayer = new L.tileLayer('https://geodata.nationaalgeoregister.nl/tiles/service/wmts/brtachtergrondkaartgrijs/EPSG:28992/{z}/{x}/{y}.png', {
        minZoom: 0,
        maxZoom: 14,
        tms: true
    });
    var map = new L.Map('map', {
        crs: RD,
        layers: [brtLayer]
    });

    var xhr = new XMLHttpRequest();
    
    var kunt = window.location.href

    var url = '/collections/begroeidterreindeel/items?f=json&limit=100&offset=0';
    xhr.open('GET', kunt.replace("html", "json"));
    var onError = function() {
        vectorSource.removeLoadedExtent(extent);
    };
    xhr.onerror = onError;
    xhr.onload = function() {
        if (xhr.status == 200) {
            var geoLayer = L.Proj.geoJson(JSON.parse(xhr.responseText));
            geoLayer.addTo(map);
            map.setView(geoLayer.getBounds().getCenter(), 3);
            map.fitBounds(geoLayer.getBounds());
        } else {
            onError();
        }
    };
    xhr.send();
</script>

<h3>Properties</h3>

{{ if  gt .NumberReturned  0 }}

    <table class="pure-table pure-table-bordered">
        <thead>
        <tr>
            <th>ID</th>
            {{$feature :=  index .Features 0}}
            {{range  $k, $v :=  $feature.Properties}}
                <th>{{$k}}</th>
            {{end}}

        </tr>
        </thead>

        <tbody>
        {{range  $i, $feature := .Features}}
            <tr {{if isOdd $i}}class="pure-table-odd" {{end}}>
                <td>{{$feature.ID}}</td>
                {{range  $k, $v :=  $feature.Properties}}
                    <td>{{$v}}</td>
                {{end}}
            </tr>
        {{end}}
        </tbody>
    </table>

{{ else }}
    <h4>No results</h4>
{{end}}


</body>
</html>